<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>cf.aggregate &#8212; Documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.3.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cf.relative_vorticity" href="cf.relative_vorticity.html" />
    <link rel="prev" title="cf.write" href="cf.write.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="cf.relative_vorticity.html" title="cf.relative_vorticity"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cf.write.html" title="cf.write"
             accesskey="P">previous</a> |</li>
  <li><a target="_blank" href="../../archive.html">Archive</a> &laquo;</li>
  <li><a target="_blank" href="http://cfpython.bitbucket.io">cf-python 2.3.3</a> &raquo;</li>
<!--
  <li><a target="_blank" href="http://cfpython.bitbucket.io">cf-python</a> &raquo;</li>
  <li><select onchange="location = this.options[this.selectedIndex].value;">

      <option value="../../1.0/index.html">1.0

      <option value="../../0.9.9/index.html">0.9.9

      <option value="../../0.9.8.3/index.html">0.9.8.3

      <option value="../../archive.html">Archive

      </select>
  </li>
-->
  
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../reference.html" >Reference manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../function.html" accesskey="U">Functions of the <code class="docutils literal"><span class="pre">cf</span></code> module</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cf-aggregate">
<h1>cf.aggregate<a class="headerlink" href="#cf-aggregate" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="cf.aggregate">
<code class="descclassname">cf.</code><code class="descname">aggregate</code><span class="sig-paren">(</span><em>fields</em>, <em>info=0</em>, <em>relaxed_units=False</em>, <em>no_overlap=False</em>, <em>contiguous=False</em>, <em>relaxed_identities=False</em>, <em>ncvar_identities=False</em>, <em>respect_valid=False</em>, <em>equal_all=False</em>, <em>exist_all=False</em>, <em>equal=None</em>, <em>exist=None</em>, <em>ignore=None</em>, <em>exclude=False</em>, <em>dimension=()</em>, <em>concatenate=True</em>, <em>copy=True</em>, <em>axes=None</em>, <em>donotchecknonaggregatingaxes=False</em>, <em>allow_no_identity=False</em>, <em>shared_nc_domain=False</em>, <em>atol=None</em>, <em>rtol=None</em><span class="sig-paren">)</span><a class="reference external" href="https://bitbucket.org/cfpython/cf-python/src/v2.3.3/cf/aggregate.py#aggregate.py-1302"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cf.aggregate" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate fields into as few fields as possible.</p>
<p>The aggregation of fields may be thought of as the combination fields
into each other to create a new field that occupies a larger domain.</p>
<p>Using the CF aggregation rules, input fields are separated into
aggregatable groups and each group (which may contain just one field)
is then aggregated to a single field. These aggregated fields are
returned in a field list.</p>
<p><strong>Identities</strong></p>
<p>In order for aggregation to be possible, fields and their components
need to be unambiguously identifiable. By default, these identities
are taken from <code class="xref py py-obj docutils literal"><span class="pre">standard_name</span></code> CF properties or else <code class="xref py py-obj docutils literal"><span class="pre">id</span></code>
attributes. If both of these identifiers are absent then <code class="xref py py-obj docutils literal"><span class="pre">long_name</span></code>
CF properties or else <code class="xref py py-obj docutils literal"><span class="pre">ncvar</span></code> attributes may be used if the
<em>relaxed_identities</em> parameter is True.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt>fields: <a class="reference internal" href="../classes/cf.FieldList.html#cf.FieldList" title="cf.FieldList"><code class="xref py py-obj docutils literal"><span class="pre">cf.FieldList</span></code></a> or sequence of <a class="reference internal" href="../classes/cf.Field.html#cf.Field" title="cf.Field"><code class="xref py py-obj docutils literal"><span class="pre">cf.Field</span></code></a></dt>
<dd><p class="first last">The fields to aggregated.</p>
</dd>
<dt>info: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">int</span></code></a>, optional</dt>
<dd><p class="first last">Print information about the aggregation process. If <em>info</em> is
0 then no information is displayed.  If <em>info</em> is 1 or more
then display information on which fields are unaggregatable,
and why. If <em>info</em> is 2 or more then display the structural
signatures of the fields and, when there is more than one
field with the same structural signature, their canonical
first and last coordinate values.  If <em>info</em> is 3 or more then
display the fields&#8217; complete aggregation metadata. By default
<em>info</em> is 0 and no information is displayed.</p>
</dd>
<dt>no_overlap: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then require that aggregated fields have adjacent
dimension coordinate object cells which do not overlap (but
they may share common boundary values). Ignored if the
dimension coordinates objects do not have bounds. See the
<em>contiguous</em> parameter.</p>
</dd>
<dt>contiguous: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then require that aggregated fields have adjacent
dimension coordinate object cells which partially overlap or
share common boundary values. Ignored if the dimension
coordinate objects do not have bounds. See the <em>no_overlap</em>
parameter.</p>
</dd>
<dt>relaxed_units: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then assume that fields or domain items (such as
coordinate objects) with the same identity (as returned by
their <code class="xref py py-obj docutils literal"><span class="pre">identity</span></code> methods) but missing units all have
equivalent but unspecified units, so that aggregation may
occur. By default such fields are not aggregatable.</p>
</dd>
<dt>allow_no_identity: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then treat fields with data arrays but with no
identities (see the above notes) as having equal but
unspecified identities, so that aggregation may occur. By
default such fields are not aggregatable.</p>
</dd>
<dt>relaxed_identities: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then allow fields and their components to be
identified by their <code class="xref py py-obj docutils literal"><span class="pre">long_name</span></code> CF properties or else
<code class="xref py py-obj docutils literal"><span class="pre">ncvar</span></code> attributes if their <code class="xref py py-obj docutils literal"><span class="pre">standard_name</span></code> CF properties or
<code class="xref py py-obj docutils literal"><span class="pre">id</span></code> attributes are missing.</p>
</dd>
<dt>ncvar_identities: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then Force fields and their components (such as
coordinates) to be identified by their netCDF file variable
names.</p>
</dd>
<dt>shared_nc_domain: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then match axes between a field and its contained
ancillary variable and coordinate reference fields via their
netCDF dimension names and not via their domains.</p>
</dd>
<dt>equal_all: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then require that aggregated fields have the same set
of non-standard CF properties (including
<a class="reference internal" href="cf.Field.long_name.html#cf.Field.long_name" title="cf.Field.long_name"><code class="xref py py-obj docutils literal"><span class="pre">long_name</span></code></a>), with the same values. See the
<em>concatenate</em> parameter.</p>
</dd>
<dt>equal_ignore: (sequence of) <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>, optional</dt>
<dd><p class="first last">Specify CF properties to omit from any properties specified by
or implied by the <em>equal_all</em> and <em>equal</em> parameters.</p>
</dd>
<dt>equal: (sequence of) <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>, optional</dt>
<dd><p class="first last">Specify CF properties for which it is required that aggregated
fields all contain the properties, with the same values. See
the <em>concatenate</em> parameter.</p>
</dd>
<dt>exist_all: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then require that aggregated fields have the same set
of non-standard CF properties (including, in this case,
long_name), but not requiring the values to be the same. See
the <em>concatenate</em> parameter.</p>
</dd>
<dt>exist_ignore: (sequence of) <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>, optional</dt>
<dd><p class="first last">Specify CF properties to omit from the properties specified by
or implied by the <em>exist_all</em> and <em>exist</em> parameters.</p>
</dd>
<dt>exist: (sequence of) <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>, optional</dt>
<dd><p class="first last">Specify CF properties for which it is required that aggregated
fields all contain the properties, but not requiring the
values to be the same. See the <em>concatenate</em> parameter.</p>
</dd>
<dt>respect_valid: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True then the CF properties <a class="reference internal" href="cf.Field.valid_min.html#cf.Field.valid_min" title="cf.Field.valid_min"><code class="xref py py-obj docutils literal"><span class="pre">valid_min</span></code></a>,
<a class="reference internal" href="cf.Field.valid_max.html#cf.Field.valid_max" title="cf.Field.valid_max"><code class="xref py py-obj docutils literal"><span class="pre">valid_max</span></code></a> and <a class="reference internal" href="cf.Field.valid_range.html#cf.Field.valid_range" title="cf.Field.valid_range"><code class="xref py py-obj docutils literal"><span class="pre">valid_range</span></code></a> are taken
into account during aggregation. I.e. a requirement for
aggregation is that fields have identical values for each
these attributes, if set. By default these CF properties are
ignored and are not set in the output fields.</p>
</dd>
<dt>dimension: (sequence of) <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>, optional</dt>
<dd><p class="first last">Create new axes for each input field which has one or more of
the given properties. For each CF property name specified, if
an input field has the property then, prior to aggregation, a
new axis is created with an auxiliary coordinate whose datum
is the property&#8217;s value and the property itself is deleted
from that field.</p>
</dd>
<dt>concatenate: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If False then a CF property is omitted from an aggregated
field if the property has unequal values across constituent
fields or is missing from at least one constituent field. By
default a CF property in an aggregated field is the
concatenated collection of the distinct values from the
constituent fields, delimited with the string
<code class="docutils literal"><span class="pre">'</span> <span class="pre">:AGGREGATED:</span> <span class="pre">'</span></code>.</p>
</dd>
<dt>copy: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If False then do not copy fields prior to aggregation.
Setting this option to False may change input fields in place,
and the output fields may not be independent of the
inputs. However, if it is known that the input fields are
never to accessed again (such as in this case: <code class="docutils literal"><span class="pre">f</span> <span class="pre">=</span>
<span class="pre">cf.aggregate(f)</span></code>) then setting <em>copy</em> to False can reduce the
time taken for aggregation.</p>
</dd>
<dt>axes: (sequence of) <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">str</span></code></a>, optional</dt>
<dd><p class="first last">Select axes to aggregate over. Aggregation will only occur
over as large a subset as possible of these axes. Each axis is
identified by the exact identity of a one dimensional
coordinate object, as returned by its <code class="xref py py-obj docutils literal"><span class="pre">identity</span></code>
method. Aggregations over more than one axis will occur in the
order given. By default, aggregation will be over as many axes
as possible.</p>
</dd>
<dt>donotchecknonaggregatingaxes: <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><code class="xref py py-obj docutils literal"><span class="pre">bool</span></code></a>, optional</dt>
<dd><p class="first last">If True, and <em>axes</em> is set, then checks for consistent data
array values will only be made for one dimensional coordinate
objects which span the any of the given aggregating axes. This
can reduce the time taken for aggregation, but if any those
checks would have failed then this clearly allows the
possibility of an incorrect result. Therefore, this option
should only be used in cases for which it is known that the
non-aggregating axes are in fact already entirely consistent.</p>
</dd>
<dt>atol: float, optional</dt>
<dd><p class="first last">The absolute tolerance for all numerical comparisons. The
tolerance is a non-negative, typically very small number. Two
numbers, x and y, are considered the same if <span class="math">\(|x-y| \le
atol + rtol*|y|\)</span>. By default the value returned by the <a class="reference internal" href="cf.ATOL.html#cf.ATOL" title="cf.ATOL"><code class="xref py py-obj docutils literal"><span class="pre">ATOL</span></code></a>
function is used.</p>
</dd>
<dt>rtol: float, optional</dt>
<dd><p class="first last">The relative tolerance for all numerical comparisons. The
tolerance is a non-negative, typically very small number. Two
numbers, x and y, are considered the same if <span class="math">\(|x-y| \le
atol + rtol*|y|\)</span>. By default the value returned by the <a class="reference internal" href="cf.RTOL.html#cf.RTOL" title="cf.RTOL"><code class="xref py py-obj docutils literal"><span class="pre">RTOL</span></code></a>
function is used.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt>out: <a class="reference internal" href="../classes/cf.FieldList.html#cf.FieldList" title="cf.FieldList"><code class="xref py py-obj docutils literal"><span class="pre">cf.FieldList</span></code></a></dt>
<dd><p class="first last">The aggregated fields.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<p>The following six fields comprise eastward wind at two different times
and for three different atmospheric heights for each time:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span>
<span class="go">[&lt;CF Field: eastward_wind(latitude(73), longitude(96)&gt;,</span>
<span class="go"> &lt;CF Field: eastward_wind(latitude(73), longitude(96)&gt;,</span>
<span class="go"> &lt;CF Field: eastward_wind(latitude(73), longitude(96)&gt;,</span>
<span class="go"> &lt;CF Field: eastward_wind(latitude(73), longitude(96)&gt;,</span>
<span class="go"> &lt;CF Field: eastward_wind(latitude(73), longitude(96)&gt;,</span>
<span class="go"> &lt;CF Field: eastward_wind(latitude(73), longitude(96)&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span>
<span class="go">[&lt;CF Field: eastward_wind(height(3), time(2), latitude(73), longitude(96)&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">source</span>
<span class="go">&#39;Model A&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;source&#39;</span><span class="p">,))</span>
<span class="go">[&lt;CF Field: eastward_wind(source(1), height(3), time(2), latitude(73), longitude(96)&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">source</span>
<span class="go">AttributeError: &#39;Field&#39; object has no attribute &#39;source&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="cf.write.html"
                        title="previous chapter">cf.write</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="cf.relative_vorticity.html"
                        title="next chapter">cf.relative_vorticity</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/generated/cf.aggregate.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="cf.relative_vorticity.html" title="cf.relative_vorticity"
             >next</a> |</li>
        <li class="right" >
          <a href="cf.write.html" title="cf.write"
             >previous</a> |</li>
  <li><a target="_blank" href="../../archive.html">Archive</a> &laquo;</li>
  <li><a target="_blank" href="http://cfpython.bitbucket.io">cf-python 2.3.3</a> &raquo;</li>
<!--
  <li><a target="_blank" href="http://cfpython.bitbucket.io">cf-python</a> &raquo;</li>
  <li><select onchange="location = this.options[this.selectedIndex].value;">

      <option value="../../1.0/index.html">1.0

      <option value="../../0.9.9/index.html">0.9.9

      <option value="../../0.9.8.3/index.html">0.9.8.3

      <option value="../../archive.html">Archive

      </select>
  </li>
-->
  
        <li class="nav-item nav-item-0"><a href="../index.html">Documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../reference.html" >Reference manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../function.html" >Functions of the <code class="docutils literal"><span class="pre">cf</span></code> module</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, David Hassell.
      Last updated on Mar 18, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>