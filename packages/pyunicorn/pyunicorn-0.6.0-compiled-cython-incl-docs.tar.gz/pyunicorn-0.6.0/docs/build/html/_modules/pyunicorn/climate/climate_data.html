<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pyunicorn.climate.climate_data &#8212; pyunicorn 0.5.2 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.5.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../../index.html"><img src="../../../_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../sitemap.html">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../sitemap.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../download.html">Download</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../methods.html">Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api_doc.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publications.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contact.html">Contact</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pyunicorn.climate.climate_data</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#</span>
<span class="c1"># This file is part of pyunicorn.</span>
<span class="c1"># Copyright (C) 2008--2019 Jonathan F. Donges and pyunicorn authors</span>
<span class="c1"># URL: &lt;http://www.pik-potsdam.de/members/donges/software&gt;</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Provides classes for generating and analyzing complex climate networks.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#</span>
<span class="c1">#  Import essential packages</span>
<span class="c1">#</span>

<span class="c1">#  Import NumPy for the array object and fast numerics</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">random</span>

<span class="kn">from</span> <span class="nn">..core</span> <span class="k">import</span> <span class="n">Data</span>


<span class="c1">#</span>
<span class="c1">#  Define class ClimateData</span>
<span class="c1">#</span>
<div class="viewcode-block" id="ClimateData"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData">[docs]</a><span class="k">class</span> <span class="nc">ClimateData</span><span class="p">(</span><span class="n">Data</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Encapsulates spatio-temporal climate data.</span>

<span class="sd">    Provides methods to manipulate this data, i.e. calculate daily (monthly)</span>
<span class="sd">    mean values and anomaly values.</span>

<span class="sd">    @ivar data_source: (string) - The name of the data source</span>
<span class="sd">                                  (model, reanalysis, station)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#</span>
    <span class="c1">#  Defines internal methods</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="ClimateData.__init__"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">time_cycle</span><span class="p">,</span> <span class="n">anomalies</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">observable_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">observable_long_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">silence_level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an instance of ClimateData.</span>

<span class="sd">        The spatio-temporal window is described by the following</span>
<span class="sd">        dictionary::</span>

<span class="sd">            window = {&quot;time_min&quot;: 0., &quot;time_max&quot;: 0., &quot;lat_min&quot;: 0.,</span>
<span class="sd">                      &quot;lat_max&quot;: 0., &quot;lon_min&quot;: 0., &quot;lon_max&quot;: 0.}</span>

<span class="sd">        :type observable: 2D array [time, index]</span>
<span class="sd">        :arg observable: The array of time series to be represented by the</span>
<span class="sd">            :class:`.Data` instance.</span>
<span class="sd">        :type grid: :class:`.Grid` instance</span>
<span class="sd">        :arg grid: The Grid representing the spatial coordinates associated to</span>
<span class="sd">            the time series and their temporal sampling.</span>
<span class="sd">        :arg int time_cycle: The annual cycle length of the data (units of</span>
<span class="sd">            samples).</span>
<span class="sd">        :arg bool anomalies: Indicates whether the data are climatological</span>
<span class="sd">            anomaly values.</span>
<span class="sd">        :arg str observable_name: A short name for the observable.</span>
<span class="sd">        :arg str observable_long_name: A long name for the observable.</span>
<span class="sd">        :arg dict window: Spatio-temporal window to select a view on the data.</span>
<span class="sd">        :arg int silence_level: The inverse level of verbosity of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Data</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="n">observable</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span>
                      <span class="n">observable_name</span><span class="o">=</span><span class="n">observable_name</span><span class="p">,</span>
                      <span class="n">observable_long_name</span><span class="o">=</span><span class="n">observable_long_name</span><span class="p">,</span>
                      <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">silence_level</span><span class="o">=</span><span class="n">silence_level</span><span class="p">)</span>

        <span class="c1">#  Set class variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span> <span class="o">=</span> <span class="n">time_cycle</span>
        <span class="sd">&quot;&quot;&quot;(number (int)) - The annual cycle length of the data</span>
<span class="sd">                            (units of samples).&quot;&quot;&quot;</span>

        <span class="c1">#  Set flags</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flag_phase_mean</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_phase_mean</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_source</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="c1"># If data are anomalies skip automatic calculation of anomalies</span>
        <span class="k">if</span> <span class="n">anomalies</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flag_anomaly</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anomaly</span> <span class="o">=</span> <span class="n">observable</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flag_anomaly</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ClimateData.__str__"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;ClimateData:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">Data</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClimateData.clear_cache"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.clear_cache">[docs]</a>    <span class="k">def</span> <span class="nf">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clean up cache.</span>

<span class="sd">        Is reversible, since all cached information can be recalculated from</span>
<span class="sd">        basic data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Data</span><span class="o">.</span><span class="n">clear_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_phase_mean</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_mean</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flag_phase_mean</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_anomaly</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anomaly</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flag_anomaly</span> <span class="o">=</span> <span class="kc">False</span></div>

    <span class="c1">#</span>
    <span class="c1">#  Define alternative constructors</span>
    <span class="c1">#</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="ClimateData.Load"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.Load">[docs]</a>    <span class="k">def</span> <span class="nf">Load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">observable_name</span><span class="p">,</span> <span class="n">time_cycle</span><span class="p">,</span>
             <span class="n">time_name</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">latitude_name</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="n">longitude_name</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
             <span class="n">data_source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;NetCDF&quot;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">vertical_level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">silence_level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an instance of ClimateData.</span>

<span class="sd">        Supported file types ``file_type`` are:</span>
<span class="sd">          - &quot;NetCDF&quot; for regular (rectangular) grids</span>
<span class="sd">          - &quot;iNetCDF&quot; for irregular (e.g. geodesic) grids or station data.</span>

<span class="sd">        The :index:`spatio-temporal window` is described by the following</span>
<span class="sd">        dictionary::</span>

<span class="sd">            window = {&quot;time_min&quot;: 0., &quot;time_max&quot;: 0., &quot;lat_min&quot;: 0.,</span>
<span class="sd">                      &quot;lat_max&quot;: 0., &quot;lon_min&quot;: 0., &quot;lon_max&quot;: 0.}</span>

<span class="sd">        :arg str file_name: The name of the data file.</span>
<span class="sd">        :arg str observable_name: The short name of the observable within data</span>
<span class="sd">            file (particularly relevant for NetCDF).</span>
<span class="sd">        :arg int time_cycle: The annual cycle length of the data (units of</span>
<span class="sd">            samples).</span>
<span class="sd">        :arg str time_name: The name of the time variable within data file.</span>
<span class="sd">        :arg str latitude_name: The name of the latitude variable within data</span>
<span class="sd">            file.</span>
<span class="sd">        :arg str longitude_name: The name of longitude variable within data</span>
<span class="sd">            file.</span>
<span class="sd">        :arg str data_source: The name of the data source (model, reanalysis,</span>
<span class="sd">            station).</span>
<span class="sd">        :arg str file_type: The format of the data file.</span>
<span class="sd">        :arg dict window: Spatio-temporal window to select a view on the data.</span>
<span class="sd">        :arg int vertical_level: The vertical level to be extracted from the</span>
<span class="sd">            data file. Is ignored for horizontal data sets. If None, the first</span>
<span class="sd">            level in the data file is chosen.</span>
<span class="sd">        :arg int silence_level: The inverse level of verbosity of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dimension_names</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">time_name</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="n">latitude_name</span><span class="p">,</span>
                           <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="n">longitude_name</span><span class="p">}</span>

        <span class="c1">#  Load data using _load_data method from parent class</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_load_data</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="n">file_type</span><span class="p">,</span>
                             <span class="n">dimension_names</span><span class="o">=</span><span class="n">dimension_names</span><span class="p">,</span>
                             <span class="n">observable_name</span><span class="o">=</span><span class="n">observable_name</span><span class="p">,</span>
                             <span class="n">vertical_level</span><span class="o">=</span><span class="n">vertical_level</span><span class="p">)</span>

        <span class="c1">#  Create instance of ClimateData</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;observable&quot;</span><span class="p">],</span> <span class="n">grid</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;grid&quot;</span><span class="p">],</span>
                   <span class="n">time_cycle</span><span class="o">=</span><span class="n">time_cycle</span><span class="p">,</span>
                   <span class="n">observable_name</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;observable_name&quot;</span><span class="p">],</span>
                   <span class="n">observable_long_name</span><span class="o">=</span><span class="n">res</span><span class="p">[</span><span class="s2">&quot;observable_long_name&quot;</span><span class="p">],</span>
                   <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">silence_level</span><span class="o">=</span><span class="n">silence_level</span><span class="p">)</span>

        <span class="c1">#  Set class variables</span>
        <span class="n">data</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">file_name</span>
        <span class="n">data</span><span class="o">.</span><span class="n">file_type</span> <span class="o">=</span> <span class="n">file_type</span>
        <span class="n">data</span><span class="o">.</span><span class="n">vertical_level</span> <span class="o">=</span> <span class="n">vertical_level</span>
        <span class="n">data</span><span class="o">.</span><span class="n">data_source</span> <span class="o">=</span> <span class="n">data_source</span>

        <span class="k">return</span> <span class="n">data</span></div>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="ClimateData.SmallTestData"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.SmallTestData">[docs]</a>    <span class="k">def</span> <span class="nf">SmallTestData</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return test data set of 6 time series with 10 sampling points each.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; r(Data.SmallTestData().observable())</span>
<span class="sd">        array([[ 0.    ,  1.    ,  0.    , -1.    , -0.    ,  1.    ],</span>
<span class="sd">               [ 0.309 ,  0.9511, -0.309 , -0.9511,  0.309 ,  0.9511],</span>
<span class="sd">               [ 0.5878,  0.809 , -0.5878, -0.809 ,  0.5878,  0.809 ],</span>
<span class="sd">               [ 0.809 ,  0.5878, -0.809 , -0.5878,  0.809 ,  0.5878],</span>
<span class="sd">               [ 0.9511,  0.309 , -0.9511, -0.309 ,  0.9511,  0.309 ],</span>
<span class="sd">               [ 1.    ,  0.    , -1.    , -0.    ,  1.    ,  0.    ],</span>
<span class="sd">               [ 0.9511, -0.309 , -0.9511,  0.309 ,  0.9511, -0.309 ],</span>
<span class="sd">               [ 0.809 , -0.5878, -0.809 ,  0.5878,  0.809 , -0.5878],</span>
<span class="sd">               [ 0.5878, -0.809 , -0.5878,  0.809 ,  0.5878, -0.809 ],</span>
<span class="sd">               [ 0.309 , -0.9511, -0.309 ,  0.9511,  0.309 , -0.9511]])</span>

<span class="sd">        :rtype: ClimateData instance</span>
<span class="sd">        :return: a ClimateData instance for testing purposes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="o">.</span><span class="n">SmallTestData</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ClimateData</span><span class="p">(</span><span class="n">observable</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">observable</span><span class="p">(),</span> <span class="n">grid</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">grid</span><span class="p">,</span>
                           <span class="n">time_cycle</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">silence_level</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

    <span class="c1">#</span>
    <span class="c1">#  Define methods to work with (climatological) anomaly data</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="ClimateData.phase_indices"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.phase_indices">[docs]</a>    <span class="k">def</span> <span class="nf">phase_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return time indices associated to all phases in the annual cycle.</span>

<span class="sd">        In other words, provides all time indices falling into a particular</span>
<span class="sd">        day, month etc. of the year.</span>

<span class="sd">        Just includes measurements from years for which complete data exists.</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; ClimateData.SmallTestData().phase_indices()</span>
<span class="sd">        array([[0, 5], [1, 6], [2, 7], [3, 8], [4, 9]])</span>

<span class="sd">        :rtype: 2D Numpy array (int) [phase index, year]</span>
<span class="sd">        :return: the time indices associated to all phases of the annual cycle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">range_years</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">grid_size</span><span class="p">()[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>
                          <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span><span class="p">)</span>

        <span class="n">phase_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span><span class="p">,</span> <span class="n">range_years</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span><span class="p">):</span>
            <span class="n">phase_indices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">range_years</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">phase_indices</span></div>

<div class="viewcode-block" id="ClimateData.indices_selected_phases"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.indices_selected_phases">[docs]</a>    <span class="k">def</span> <span class="nf">indices_selected_phases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_phases</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return sorted time indices associated to certain phase indices.</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; ClimateData.SmallTestData().indices_selected_phases([0,1,4])</span>
<span class="sd">        array([0, 1, 4, 5, 6, 9])</span>

<span class="sd">        :arg [int] selected_phases: The selected phase indices.</span>
<span class="sd">        :rtype: 1D array (int)</span>
<span class="sd">        :return: the sorted time indices corresponding to chosen phase indices.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#  Get all</span>
        <span class="n">phase_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_indices</span><span class="p">()</span>

        <span class="c1">#  Select time indices corresponding to chosen phase indices</span>
        <span class="n">selected_indices</span> <span class="o">=</span> <span class="n">phase_indices</span><span class="p">[</span><span class="n">selected_phases</span><span class="p">,</span> <span class="p">:]</span>

        <span class="c1">#  Flatten and sort selected time indices</span>
        <span class="n">selected_indices</span> <span class="o">=</span> <span class="n">selected_indices</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">selected_indices</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">selected_indices</span></div>

<div class="viewcode-block" id="ClimateData.indices_selected_months"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.indices_selected_months">[docs]</a>    <span class="k">def</span> <span class="nf">indices_selected_months</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_months</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return sorted time indices associated to certain months.</span>

<span class="sd">        Currently, only cycle lengths of 12 (monthly data) and 360</span>
<span class="sd">        (standardized daily data) are supported.</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        :arg [number] selected_months: The selected months.</span>
<span class="sd">        :rtype: 1D array (int)</span>
<span class="sd">        :return: the sorted time indices corresponding to chosen months.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_selected_phases</span><span class="p">(</span><span class="n">selected_months</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span> <span class="o">==</span> <span class="mi">360</span><span class="p">:</span>
            <span class="n">selected_days</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">selected_months</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
                    <span class="n">selected_days</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">month</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="n">day</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_selected_phases</span><span class="p">(</span><span class="n">selected_days</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Currently only time cycles 12 and 360 </span><span class="se">\</span>
<span class="s2">                                      are supported&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ClimateData._calculate_phase_mean"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData._calculate_phase_mean">[docs]</a>    <span class="k">def</span> <span class="nf">_calculate_phase_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate mean values of observable for each phase of the annual cycle.</span>

<span class="sd">        This is also commonly referred to as climatological mean, e.g., the</span>
<span class="sd">        mean temperature for all Januaries in the data set for monthly time</span>
<span class="sd">        resolution (time_cycle=12).</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        :rtype: 2D Numpy array [cycle index, node index]</span>
<span class="sd">        :return: the mean values of observable for each phase of the annual</span>
<span class="sd">                 cycle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">silence_level</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Calculating climatological mean values...&quot;</span><span class="p">)</span>

        <span class="c1">#  Get raw data</span>
        <span class="n">observable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">observable</span><span class="p">()</span>
        <span class="c1">#  Get time cycle</span>
        <span class="n">time_cycle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span>

        <span class="c1">#  Get number of time series</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">observable</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1">#  Initialize</span>
        <span class="n">phase_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">time_cycle</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>

        <span class="c1">#  Calculate mean value for each day (month) on each node</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">time_cycle</span><span class="p">):</span>
            <span class="n">phase_mean</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">observable</span><span class="p">[</span><span class="n">i</span><span class="p">::</span><span class="n">time_cycle</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">phase_mean</span></div>

<div class="viewcode-block" id="ClimateData.phase_mean"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.phase_mean">[docs]</a>    <span class="k">def</span> <span class="nf">phase_mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return mean values of observable for each phase of the annual cycle.</span>

<span class="sd">        For further comments, see :meth:`_calculate_phase_mean`.</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; r(ClimateData.SmallTestData().phase_mean())</span>
<span class="sd">        array([[ 0.5   ,  0.5   , -0.5   , -0.5   ,  0.5   ,  0.5   ],</span>
<span class="sd">               [ 0.63  ,  0.321 , -0.63  , -0.321 ,  0.63  ,  0.321 ],</span>
<span class="sd">               [ 0.6984,  0.1106, -0.6984, -0.1106,  0.6984,  0.1106],</span>
<span class="sd">               [ 0.6984, -0.1106, -0.6984,  0.1106,  0.6984, -0.1106],</span>
<span class="sd">               [ 0.63  , -0.321 , -0.63  ,  0.321 ,  0.63  , -0.321 ]])</span>

<span class="sd">        :rtype: 2D Numpy array [cycle index, node index]</span>
<span class="sd">        :return: the mean values of observable for each phase of the annual</span>
<span class="sd">                 cycle.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_phase_mean</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_phase_mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_phase_mean</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flag_phase_mean</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase_mean</span></div>

<div class="viewcode-block" id="ClimateData._calculate_anomaly"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData._calculate_anomaly">[docs]</a>    <span class="k">def</span> <span class="nf">_calculate_anomaly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate anomaly time series from observable.</span>

<span class="sd">        To obtain climatological anomaly time series, the climatological means</span>
<span class="sd">        are subtracted from each sample in the original time series. This</span>
<span class="sd">        procedure is also known as phase averaging.</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        :rtype: 2D Numpy array [time, node index]</span>
<span class="sd">        :return: the anomalized time series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">silence_level</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Calculating daily (monthly) anomaly values...&quot;</span><span class="p">)</span>

        <span class="c1">#  Get raw data</span>
        <span class="n">observable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">observable</span><span class="p">()</span>
        <span class="c1">#  Get time cycle</span>
        <span class="n">time_cycle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_cycle</span>
        <span class="c1">#  Initialize array</span>
        <span class="n">anomaly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">observable</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="c1">#  Thanks to Jakob Runge</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">time_cycle</span><span class="p">):</span>
            <span class="n">sample</span> <span class="o">=</span> <span class="n">observable</span><span class="p">[</span><span class="n">i</span><span class="p">::</span><span class="n">time_cycle</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">anomaly</span><span class="p">[</span><span class="n">i</span><span class="p">::</span><span class="n">time_cycle</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">sample</span> <span class="o">-</span> <span class="n">sample</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">anomaly</span></div>

<div class="viewcode-block" id="ClimateData.anomaly"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.anomaly">[docs]</a>    <span class="k">def</span> <span class="nf">anomaly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return anomaly time series from observable.</span>

<span class="sd">        For further comments, see :meth:`_calculate_anomaly`.</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; r(ClimateData.SmallTestData().anomaly()[:,0])</span>
<span class="sd">        array([-0.5 , -0.321 , -0.1106,  0.1106,  0.321 ,</span>
<span class="sd">                0.5 ,  0.321 ,  0.1106, -0.1106, -0.321 ])</span>

<span class="sd">        :rtype: 2D Numpy array [time, node index]</span>
<span class="sd">        :return: the anomalized time series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_anomaly</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_anomaly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_anomaly</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_flag_anomaly</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anomaly</span></div>

<div class="viewcode-block" id="ClimateData.anomaly_selected_months"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.anomaly_selected_months">[docs]</a>    <span class="k">def</span> <span class="nf">anomaly_selected_months</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_months</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return anomaly time series from observable for selected months.</span>

<span class="sd">        For further comments, see :meth:`_calculate_anomaly`.</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        :arg [number] selected_months: The selected months.</span>
<span class="sd">        :rtype:  2D array [time, node index]</span>
<span class="sd">        :return: the anomalized time series for selected months.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">selected_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indices_selected_months</span><span class="p">(</span><span class="n">selected_months</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">selected_indices</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly</span><span class="p">()[</span><span class="n">selected_indices</span><span class="p">,</span> <span class="p">:]</span></div>

<div class="viewcode-block" id="ClimateData.shuffled_anomaly"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.shuffled_anomaly">[docs]</a>    <span class="k">def</span> <span class="nf">shuffled_anomaly</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the randomly shuffled anomaly time series.</span>

<span class="sd">        Each anomaly time series is shuffled individually.</span>

<span class="sd">        .. note::</span>
<span class="sd">           Only the currently selected spatio-temporal window is considered.</span>

<span class="sd">        **Example** (Anomaly with and without temporal shuffling should have</span>
<span class="sd">        the same standard deviation along time axis):</span>

<span class="sd">        &gt;&gt;&gt; r(ClimateData.SmallTestData().anomaly().std(axis=0))</span>
<span class="sd">        array([ 0.31 , 0.6355, 0.31 , 0.6355, 0.31 , 0.6355])</span>
<span class="sd">        &gt;&gt;&gt; r(ClimateData.SmallTestData().shuffled_anomaly().std(axis=0))</span>
<span class="sd">        array([ 0.31 , 0.6355, 0.31 , 0.6355, 0.31 , 0.6355])</span>

<span class="sd">        :rtype: 2D Numpy array [time, node index]</span>
<span class="sd">        :return: the anomalized and shuffled time series.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">silence_level</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shuffling anomaly time series for significance tests...&quot;</span><span class="p">)</span>

        <span class="n">N</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">grid_size</span><span class="p">()[</span><span class="s2">&quot;space&quot;</span><span class="p">]</span>
        <span class="n">shuffled_anomaly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">anomaly</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">anomaly</span><span class="p">()[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
            <span class="n">shuffled_anomaly</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

        <span class="k">return</span> <span class="n">shuffled_anomaly</span></div>

<div class="viewcode-block" id="ClimateData.set_window"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.set_window">[docs]</a>    <span class="k">def</span> <span class="nf">set_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set spatio-temporal window.</span>

<span class="sd">        Calls set_window method of parent class Data and additionally sets</span>
<span class="sd">        flags, so that measures derived from data (mean, anomaly) will be</span>
<span class="sd">        recalculated for new window.</span>

<span class="sd">        The spatio-temporal window is described by the following dictionary::</span>

<span class="sd">           window = {&quot;time_min&quot;: 0., &quot;time_max&quot;: 0., &quot;lat_min&quot;: 0.,</span>
<span class="sd">                     &quot;lat_max&quot;: 0., &quot;lon_min&quot;: 0., &quot;lon_max&quot;: 0.}</span>

<span class="sd">        If the temporal boundaries are equal, the data&#39;s full time range is</span>
<span class="sd">        selected. If any of the two corresponding spatial boundaries are</span>
<span class="sd">        equal, the data&#39;s full spatial extension is included.</span>

<span class="sd">        For more information see :meth:`pyunicorn.Data.set_window`.</span>

<span class="sd">        **Example:**</span>

<span class="sd">        &gt;&gt;&gt; data = ClimateData.SmallTestData()</span>
<span class="sd">        &gt;&gt;&gt; data.set_window(window={&quot;time_min&quot;: 0., &quot;time_max&quot;: 0.,</span>
<span class="sd">        ...                 &quot;lat_min&quot;: 10., &quot;lat_max&quot;: 20.,</span>
<span class="sd">        ...                 &quot;lon_min&quot;: 5.,  &quot;lon_max&quot;: 10.})</span>
<span class="sd">        &gt;&gt;&gt; r(data.anomaly())</span>
<span class="sd">        array([[ 0.5   , -0.5   ], [ 0.321 , -0.63  ], [ 0.1106, -0.6984],</span>
<span class="sd">               [-0.1106, -0.6984], [-0.321 , -0.63  ], [-0.5   ,  0.5   ],</span>
<span class="sd">               [-0.321 ,  0.63  ], [-0.1106,  0.6984], [ 0.1106,  0.6984],</span>
<span class="sd">               [ 0.321 ,  0.63  ]])</span>

<span class="sd">        :type window: dictionary</span>
<span class="sd">        :arg window: The spatio-temporal window to select a view on the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Data</span><span class="o">.</span><span class="n">set_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_flag_phase_mean</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flag_anomaly</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="ClimateData.set_global_window"><a class="viewcode-back" href="../../../api/climate/climate_data.html#pyunicorn.climate.climate_data.ClimateData.set_global_window">[docs]</a>    <span class="k">def</span> <span class="nf">set_global_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the view on the whole data set.</span>

<span class="sd">        Select the full data set and creates a data array as well as</span>
<span class="sd">        a corresponding Grid object to access this window from outside.</span>

<span class="sd">        **Example** (Set smaller window and subsequently restore global</span>
<span class="sd">        window):</span>

<span class="sd">        &gt;&gt;&gt; data = ClimateData.SmallTestData()</span>
<span class="sd">        &gt;&gt;&gt; data.set_window(window={&quot;time_min&quot;: 0., &quot;time_max&quot;: 4.,</span>
<span class="sd">        ...                 &quot;lat_min&quot;: 10., &quot;lat_max&quot;: 20.,</span>
<span class="sd">        ...                 &quot;lon_min&quot;: 5.,  &quot;lon_max&quot;: 10.})</span>
<span class="sd">        &gt;&gt;&gt; data.grid.grid()[&quot;lat&quot;]</span>
<span class="sd">        array([ 10.,  15.], dtype=float32)</span>
<span class="sd">        &gt;&gt;&gt; data.set_global_window()</span>
<span class="sd">        &gt;&gt;&gt; data.grid.grid()[&quot;lat&quot;]</span>
<span class="sd">        array([  0.,   5.,  10.,  15.,  20.,  25.], dtype=float32)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Data</span><span class="o">.</span><span class="n">set_global_window</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_flag_phase_mean</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_flag_anomaly</span> <span class="o">=</span> <span class="kc">False</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2008-2019, Jonathan F. Donges and pyunicorn authors.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.
    </div>
  </body>
</html>