<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Schevo Tutorial: Movie Reviews &#8212; libschevo 3.2.10 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.2.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="top" title="libschevo 3.2.10 documentation" href="../../index.html" />
    <link rel="up" title="Movie Review Tutorial" href="index.html" />
    <link rel="next" title="Schevo References" href="../../reference/index.html" />
    <link rel="prev" title="Movie Review Tutorial" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="schevo-tutorial-movie-reviews">
<h1>Schevo Tutorial: Movie Reviews<a class="headerlink" href="#schevo-tutorial-movie-reviews" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installment-1">
<h2>Installment 1<a class="headerlink" href="#installment-1" title="Permalink to this headline">¶</a></h2>
<p>In this installment of this tutorial, we will show you how to create a
skeleton Schevo application and a simple database schema. As you update the
schema, we will show you how to explore the database using the Python
interpreter. Here is what the final schema will look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;Schema for MovieReviews.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">schevo.schema</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">schevo</span><span class="o">.</span><span class="n">schema</span><span class="o">.</span><span class="n">prep</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>


<span class="k">class</span> <span class="nc">SchevoIcon</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">Entity</span><span class="p">):</span>

    <span class="n">_hidden</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">string</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">image</span><span class="p">()</span>

    <span class="n">_key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Actor</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">Entity</span><span class="p">):</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">string</span><span class="p">()</span>

    <span class="n">_key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">x_movies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">casting</span><span class="o">.</span><span class="n">movie</span>
                <span class="k">for</span> <span class="n">casting</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">movie_castings</span><span class="p">()]</span>


<span class="k">class</span> <span class="nc">Director</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">Entity</span><span class="p">):</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">string</span><span class="p">()</span>

    <span class="n">_key</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Movie</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">Entity</span><span class="p">):</span>

    <span class="n">title</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">string</span><span class="p">()</span>
    <span class="n">release_date</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">date</span><span class="p">()</span>
    <span class="n">director</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s1">&#39;Director&#39;</span><span class="p">)</span>
    <span class="n">description</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="n">multiline</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="n">_key</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">x_actors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">casting</span><span class="o">.</span><span class="n">actor</span>
                <span class="k">for</span> <span class="n">casting</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">movie_castings</span><span class="p">()]</span>

    <span class="k">def</span> <span class="fm">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">u</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%i</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">release_date</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MovieCasting</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">Entity</span><span class="p">):</span>

    <span class="n">movie</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s1">&#39;Movie&#39;</span><span class="p">,</span> <span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">actor</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">entity</span><span class="p">(</span><span class="s1">&#39;Actor&#39;</span><span class="p">)</span>

    <span class="n">_key</span><span class="p">(</span><span class="n">movie</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span>


<span class="n">E</span><span class="o">.</span><span class="n">Actor</span><span class="o">.</span><span class="n">_sample</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Keanu Reeves&#39;</span><span class="p">,</span> <span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Winona Ryder&#39;</span><span class="p">,</span> <span class="p">),</span>
    <span class="p">]</span>

<span class="n">E</span><span class="o">.</span><span class="n">Director</span><span class="o">.</span><span class="n">_sample</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;Richard Linklater&#39;</span><span class="p">,</span> <span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Stephen Herek&#39;</span><span class="p">,</span> <span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Tim Burton&#39;</span><span class="p">,</span> <span class="p">),</span>
    <span class="p">]</span>

<span class="n">E</span><span class="o">.</span><span class="n">Movie</span><span class="o">.</span><span class="n">_sample</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;A Scanner Darkly&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-07-28&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Richard Linklater&#39;</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">DEFAULT</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Bill &amp; Ted&#39;s Excellent Adventure&quot;</span><span class="p">,</span> <span class="s1">&#39;1989-02-17&#39;</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;Stephen Herek&#39;</span><span class="p">,</span> <span class="p">),</span> <span class="n">DEFAULT</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;Edward Scissorhands&#39;</span><span class="p">,</span> <span class="s1">&#39;1990-12-14&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;Tim Burton&#39;</span><span class="p">,</span> <span class="p">),</span>
        <span class="n">DEFAULT</span><span class="p">),</span>
    <span class="p">]</span>

<span class="n">E</span><span class="o">.</span><span class="n">MovieCasting</span><span class="o">.</span><span class="n">_sample</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">((</span><span class="s1">&#39;A Scanner Darkly&#39;</span><span class="p">,</span> <span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Keanu Reeves&#39;</span><span class="p">,</span> <span class="p">)),</span>
    <span class="p">((</span><span class="s1">&#39;A Scanner Darkly&#39;</span><span class="p">,</span> <span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Winona Ryder&#39;</span><span class="p">,</span> <span class="p">)),</span>
    <span class="p">((</span><span class="s2">&quot;Bill &amp; Ted&#39;s Excellent Adventure&quot;</span><span class="p">,</span> <span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Keanu Reeves&#39;</span><span class="p">,</span> <span class="p">)),</span>
    <span class="p">((</span><span class="s1">&#39;Edward Scissorhands&#39;</span><span class="p">,</span> <span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Winona Ryder&#39;</span><span class="p">,</span> <span class="p">)),</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>If you have not done so already, set up a Schevo environment as
described in <a class="reference external" href="../../install/">Getting Started With Schevo</a>.</p>
<p>This tutorial is also a doctest, so let us set up doctest
environment:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">schevo.test</span> <span class="k">import</span> <span class="n">DocTest</span>
</pre></div>
</div>
<p>For those not familiar with doctests, please note the following:</p>
<ul class="simple">
<li>Because of the way doctests are designed, you should be able to
follow this tutorial by entering Python statements <em>exactly</em> as
shown.</li>
<li>Typically, you won&#8217;t do this though; doctests are designed to be
automatically tested for correctness, but aren&#8217;t necessarily what
one would do in a real-world situation.</li>
<li>When you see code that creates a new <cite>DocTest</cite> instance (e.g. <code class="docutils literal"><span class="pre">t</span> <span class="pre">=</span>
<span class="pre">DocTest(schema)</span></code>), you can ignore it.</li>
<li>When you see code that is adding to the <cite>schema</cite> variable
(e.g. <code class="docutils literal"><span class="pre">schema</span> <span class="pre">+=</span> <span class="pre">'''</span> <span class="pre">[some</span> <span class="pre">text]</span> <span class="pre">'''</span></code>), you should just add the
text in the multi-line string to your schema file.</li>
</ul>
<div class="section" id="create-a-schevo-application">
<h3>Create a Schevo application<a class="headerlink" href="#create-a-schevo-application" title="Permalink to this headline">¶</a></h3>
<p>At a shell prompt, change to a directory that you want your new
application in, then use the <code class="docutils literal"><span class="pre">paster</span></code> tool to create a new Schevo
application:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ paster create --template=schevo MovieReviews  # [1]
$ cd MovieReviews                               # [2]
$ python setup.py develop                       # [3]
</pre></div>
</div>
<ol class="arabic simple">
<li>Create a new Schevo application called &#8220;MovieReviews&#8221;. A directory
called <code class="docutils literal"><span class="pre">MovieReviews</span></code> will be created with the new application
inside.</li>
<li>Change into the <code class="docutils literal"><span class="pre">MovieReviews</span></code> directory.</li>
<li>Install it into your Python environment in development mode.</li>
</ol>
<div class="section" id="the-default-database-schema">
<h4>The default database schema<a class="headerlink" href="#the-default-database-schema" title="Permalink to this headline">¶</a></h4>
<p>In your favorite text editor, open the file
<code class="docutils literal"><span class="pre">moviereviews/schema/moviereviews_001.py</span></code>. This is the filename
convention that Schevo uses when creating and evolving databases. The
<code class="docutils literal"><span class="pre">001</span></code> represents the version number of the schema.</p>
<p>The prefix, while typically the same as the name of the top-level
package of your project (in this case, <cite>moviereviews</cite>), can be
anything you like, although only one prefix may be used in a schema
package.</p>
</div>
<div class="section" id="namespace-preparation">
<h4>Namespace preparation<a class="headerlink" href="#namespace-preparation" title="Permalink to this headline">¶</a></h4>
<p>In the schema you will see the following lines near the top. These
prepare the module namespace with the necessary &#8220;ingredients&#8221; for the
Schevo schema syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    from schevo.schema import *     # [1]</span>
<span class="gp">... </span><span class="s1">    schevo.schema.prep(locals())    # [2]</span>
<span class="gp">... </span><span class="s1">    &#39;&#39;&#39;</span>
</pre></div>
</div>
<ol class="arabic simple">
<li>The developers of Schevo tend to eschew the careless use of
<code class="docutils literal"><span class="pre">import</span> <span class="pre">*</span></code>, but this one is rather useful.  It imports only about
13 variables, carefully named to avoid namespace clashes with the
database schema.</li>
<li>Prepare the module&#8217;s namespace for building and storing the
structure of the database schema about to be declared.</li>
</ol>
</div>
<div class="section" id="icon-storage">
<h4>Icon storage<a class="headerlink" href="#icon-storage" title="Permalink to this headline">¶</a></h4>
<p>The default schema also has a class called <code class="docutils literal"><span class="pre">SchevoIcon</span></code>. We&#8217;re not
going to take advantage of this in this tutorial, but let&#8217;s explore
this class a little bit as it will give us a template for the other
classes you&#8217;ll add to your schema:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    class SchevoIcon(E.Entity):     # [1]</span>
<span class="gp">... </span><span class="s1">        &quot;&quot;&quot;Stores icons for Schevo database and application objects.&quot;&quot;&quot;</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _hidden = True              # [2]</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        name = f.string()           # [3]</span>
<span class="gp">... </span><span class="s1">        data = f.image()            # [4]</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _key(name)                  # [5]</span>
<span class="gp">... </span><span class="s1">    &#39;&#39;&#39;</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">SchevoIcon</span></code> is an <em>entity class</em>. All entity classes subclass from
<code class="docutils literal"><span class="pre">E.Entity</span></code>. See <a class="reference external" href="../../reference/namespaces.html">Schevo Namespaces</a> to find out more about the <code class="docutils literal"><span class="pre">E</span></code>
namespace.</li>
</ol>
<ol class="arabic simple" start="2">
<li>When the database is open, the <code class="docutils literal"><span class="pre">SchevoIcon</span></code> <em>extent</em> that is
based on this class will be designated as hidden. A user interface
<em>may</em> honor this and hide this extent from the user in some way.</li>
<li><code class="docutils literal"><span class="pre">name</span></code> is a string <em>field</em>. See <a class="reference external" href="../../reference/namespaces.html">Schevo Namespaces</a> to read
more about the <code class="docutils literal"><span class="pre">f</span></code> namespace.</li>
<li><code class="docutils literal"><span class="pre">data</span></code> is an Image field.</li>
<li><code class="docutils literal"><span class="pre">(name)</span></code> is a key for the <code class="docutils literal"><span class="pre">SchevoIcon</span></code> extent. Schevo will not
allow more than one <em>entity</em> with the same value in the <code class="docutils literal"><span class="pre">name</span></code>
field in this extent.</li>
</ol>
</div>
</div>
<div class="section" id="some-terminology">
<h3>Some terminology<a class="headerlink" href="#some-terminology" title="Permalink to this headline">¶</a></h3>
<p>We&#8217;ve introduced some terms that are not necessarily unique to Schevo,
but may not be familiar for those accustomed to working with SQL. Here
are some basic definitions of those terms. We&#8217;ve left out some details
to keep this tutorial simple.</p>
<p>For more detail, visit the <a class="reference external" href="../../reference/glossary.html">Schevo Glossary</a>.</p>
<dl class="docutils">
<dt>Entity class</dt>
<dd>A class definition in a schema that describes the fields,
transactions, and other characteristics that each entity of that
type will have.</dd>
<dt>Extent</dt>
<dd>A collection object based on an entity class containing same-typed
entities in a database. Analogous to a table in a SQL database.</dd>
<dt>Entity</dt>
<dd>An object that represents a single item in the database. Analogous
to a row in a SQL database.</dd>
<dt>Field</dt>
<dd>An object that represents a property of an entity. Analogous to a
column in a SQL database.</dd>
</dl>
</div>
<div class="section" id="add-an-entity-class-for-movies">
<h3>Add an entity class for movies<a class="headerlink" href="#add-an-entity-class-for-movies" title="Permalink to this headline">¶</a></h3>
<p>Add the following class to the database schema:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    class Movie(E.Entity):</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        title = f.string()</span>
<span class="gp">... </span><span class="s1">        release_date = f.date()</span>
<span class="gp">... </span><span class="s1">        description = f.string(required=False,</span>
<span class="gp">... </span><span class="s1">                               multiline=True)  # [1], [2]</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _key(title)                             # [3]</span>
<span class="gp">... </span><span class="s1">    &#39;&#39;&#39;</span>
</pre></div>
</div>
<ol class="arabic simple">
<li>By default, <cite>String</cite> fields will store multi-line values, but user
interfaces typically render them as single-line widgets. We can
hint to the user interface that it may use a multi-line input
widget by setting <code class="docutils literal"><span class="pre">multiline=True</span></code>.</li>
<li>By default, all fields are required. <code class="docutils literal"><span class="pre">description</span></code> isn&#8217;t.</li>
<li><code class="docutils literal"><span class="pre">(title)</span></code> is a key for this extent. There can be no two movies
with the same title. This is a bit unrealistic, and indeed Schevo
allows you to specify keys such as <code class="docutils literal"><span class="pre">(title,</span> <span class="pre">release_date)</span></code>, but
we&#8217;ve simplified things for this tutorial.</li>
</ol>
</div>
<div class="section" id="create-a-database">
<h3>Create a database<a class="headerlink" href="#create-a-database" title="Permalink to this headline">¶</a></h3>
<p>Save the <code class="docutils literal"><span class="pre">moviereviews_001.py</span></code> file. At a shell prompt, use the
<code class="docutils literal"><span class="pre">schevo</span></code> tool to create a new database with the application&#8217;s
schema:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ schevo db create --app=moviereviews sample.db
</pre></div>
</div>
<p>That&#8217;s it!</p>
<p>At this point, the <code class="docutils literal"><span class="pre">sample.db</span></code> file contains your new database,
including the database schema itself.</p>
<p>For the doctest, let us create an in-memory database with the current
schema:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">DocTest</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">db</span>
</pre></div>
</div>
</div>
<div class="section" id="add-some-movies">
<h3>Add some movies<a class="headerlink" href="#add-some-movies" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">schevo</span></code> tool gives you a handy way to work with a database
using a Python interpreter. We recommend installing IPython (just run
<code class="docutils literal"><span class="pre">&quot;easy_install</span> <span class="pre">IPython&quot;</span></code>) for a very comfortable experience.</p>
<p>At a shell prompt, open the database:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ schevo shell sample.db
</pre></div>
</div>
<p>A variable <code class="docutils literal"><span class="pre">db</span></code>, representing the open database, is automatically
inserted into the namespace of the interactive session.</p>
<div class="section" id="transactions">
<h4>Transactions<a class="headerlink" href="#transactions" title="Permalink to this headline">¶</a></h4>
<p>All changes to a Schevo database are done via <em>transaction</em> objects that are
responsible for ensuring that changes made to the database follow the rules
you specify. See <a class="reference external" href="../../reference/transactions.html">Schevo Transactions</a>
for further discussion about this design decision and the benefits you gain
from it.</p>
<p>Make a new <code class="docutils literal"><span class="pre">create</span></code> transaction for creating a new <code class="docutils literal"><span class="pre">Movie</span></code>
entity. Assign values to fields, then tell the database to execute the
transaction:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Movie</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>           <span class="c1"># [1], [2], [3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;A Scanner Darkley&#39;</span>     <span class="c1"># [4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span><span class="o">.</span><span class="n">release_date</span> <span class="o">=</span> <span class="s1">&#39;2006-07-28&#39;</span>     <span class="c1"># [5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>             <span class="c1"># [6]</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">db.Movie</span></code> is the <code class="docutils literal"><span class="pre">Movie</span></code> extent in the database.</li>
<li>Extents have a <code class="docutils literal"><span class="pre">t</span></code> namespace that contains <em>transaction methods</em>.</li>
<li>By calling the <code class="docutils literal"><span class="pre">create</span></code> transaction method, we receive a
transaction object that will attempt to create a new Movie entity
upon execution.</li>
<li>Set the transaction&#8217;s fields to the values that you want the new
entity to have.</li>
<li><code class="docutils literal"><span class="pre">date</span></code> fields are smart and will accept <code class="docutils literal"><span class="pre">datetime.date</span></code> objects
as well as <code class="docutils literal"><span class="pre">YYYY-MM-DD</span></code> and <code class="docutils literal"><span class="pre">MM/DD/YYYY</span></code> formatted strings.</li>
<li>When the transaction object executes successfully, it returns the
<code class="docutils literal"><span class="pre">Movie</span></code> entity that it just created.</li>
</ol>
<p>Inspecting the field values of the entity shows that the proper
information was stored in the database:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">movie</span><span class="o">.</span><span class="n">title</span>
<span class="go">u&#39;A Scanner Darkley&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie</span><span class="o">.</span><span class="n">release_date</span>
<span class="go">datetime.date(2006, 7, 28)</span>
</pre></div>
</div>
<p>Oops! There&#8217;s a typo in the title of the movie.</p>
<p>The <code class="docutils literal"><span class="pre">movie</span></code> entity object has a <code class="docutils literal"><span class="pre">t</span></code> namespace as well. By default,
there are <code class="docutils literal"><span class="pre">update</span></code> and <code class="docutils literal"><span class="pre">delete</span></code> methods in an entity&#8217;s <code class="docutils literal"><span class="pre">t</span></code>
namespace.</p>
<p>Create an <code class="docutils literal"><span class="pre">update</span></code> transaction object, correct the name, then
execute the transaction and inspect the result:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span> <span class="o">=</span> <span class="n">movie</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tx</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;A Scanner Darkly&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie</span><span class="o">.</span><span class="n">title</span>
<span class="go">u&#39;A Scanner Darkly&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="object-representations">
<h3>Object representations<a class="headerlink" href="#object-representations" title="Permalink to this headline">¶</a></h3>
<p>At this point, you may notice that if you print the <code class="docutils literal"><span class="pre">movie</span></code> object
itself, it gives you a label based off the first <em>key</em> you define for
the extent:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">movie</span>
<span class="go">A Scanner Darkly</span>
</pre></div>
</div>
<p>Suppose in a user interface we would like to include the year the
movie was released whenever a summary of a movie entity is to be
displayed.</p>
<p>Exit the Python session, then edit <code class="docutils literal"><span class="pre">moviereviews_001.py</span></code> again and
add the <code class="docutils literal"><span class="pre">__unicode__</span></code> method to the <code class="docutils literal"><span class="pre">Movie</span></code> class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    class Movie(E.Entity):</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        title = f.string()</span>
<span class="gp">... </span><span class="s1">        release_date = f.date()</span>
<span class="gp">... </span><span class="s1">        description = f.string(multiline=True, required=False)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _key(title)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        def __unicode__(self):</span>
<span class="gp">... </span><span class="s1">            return u&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%i</span><span class="s1">)&#39; % (self.title, self.release_date.year)</span>
<span class="gp">... </span><span class="s1">    &#39;&#39;&#39;</span>
</pre></div>
</div>
<p>At a shell prompt, update the existing database using the new schema,
then open a Python session again:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ schevo db update --app=moviereviews sample.db
$ schevo shell sample.db
</pre></div>
</div>
<p>For the doctest, let us perform the equivalent operation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">db</span>
</pre></div>
</div>
<p>Find the movie, and inspect it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">movie</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Movie</span><span class="o">.</span><span class="n">findone</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;A Scanner Darkly&#39;</span><span class="p">)</span>   <span class="c1"># [1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movie</span>                       <span class="c1"># [2]</span>
<span class="go">&lt;Movie entity oid:1 rev:1&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">movie</span>                 <span class="c1"># [3]</span>
<span class="go">A Scanner Darkly (2006)</span>
</pre></div>
</div>
<ol class="arabic simple">
<li>The <code class="docutils literal"><span class="pre">findone</span></code> method of an extent finds exactly one entity in
that extent whose fields match those passed to the method. If it
can&#8217;t find any, it returns <code class="docutils literal"><span class="pre">None</span></code>. If it finds more than one, it
raises a <code class="docutils literal"><span class="pre">FindOneFoundMany</span></code> exception.</li>
<li>The <code class="docutils literal"><span class="pre">repr</span></code> representation of the entity gives you the extent
name, the entity object identifier, and the entity revision.</li>
<li>The <code class="docutils literal"><span class="pre">unicode</span></code> representation now gives you a more human-friendly
view of things, suitable not only for interactive use but also for
user interface code.</li>
</ol>
<p>Schevo likes to make things easy for humans to read, so you can go beyond
thinking of it as a &#8220;unicode representation&#8221; of something, and think of it
instead as a singular or plural <em>label</em> of an object. See <a class="reference external" href="../../reference/object-labels.html">Object Labels</a> for further discussion about this
feature.</p>
</div>
<div class="section" id="relationships">
<h3>Relationships<a class="headerlink" href="#relationships" title="Permalink to this headline">¶</a></h3>
<p>Schevo has many relational-like capabilities, and it makes it easy to
manage those.</p>
<p>We&#8217;ll flex this by having our database keep track of the director of
each movie, and the actors that are in each movie. Close your Python
session, and modify the schema to add the <code class="docutils literal"><span class="pre">Actor</span></code>, <code class="docutils literal"><span class="pre">Director</span></code>, and
<code class="docutils literal"><span class="pre">MovieCasting</span></code> classes, and to modify the <code class="docutils literal"><span class="pre">Movie</span></code> class.</p>
<p>Wait! Before we get started, think about how much data we&#8217;ll have to
populate with those transaction objects. Schevo allows you to change
the structure of a database within the same schema version to some
degree to support rapid development. Wouldn&#8217;t it also be nice to place
some sample data directly in the schema?</p>
<p>Schevo lets you do that, so take advantage of it when you modify the
schema by assigning <code class="docutils literal"><span class="pre">_sample</span></code> data lists to each entity class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    class Actor(E.Entity):</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        name = f.string()</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _key(name)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">    class Director(E.Entity):</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        name = f.string()</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _key(name)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">    class Movie(E.Entity):</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        title = f.string()</span>
<span class="gp">... </span><span class="s1">        release_date = f.date()</span>
<span class="gp">... </span><span class="s1">        director = f.entity(&#39;Director&#39;)</span>
<span class="gp">... </span><span class="s1">        description = f.string(multiline=True, required=False)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _key(title)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        def __unicode__(self):</span>
<span class="gp">... </span><span class="s1">            return u&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%i</span><span class="s1">)&#39; % (self.title, self.release_date.year)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">    class MovieCasting(E.Entity):</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        movie = f.entity(&#39;Movie&#39;, CASCADE)</span>
<span class="gp">... </span><span class="s1">        actor = f.entity(&#39;Actor&#39;)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _key(movie, actor)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        def __unicode__(self):</span>
<span class="gp">... </span><span class="s1">            return u&#39;</span><span class="si">%s</span><span class="s1"> :: </span><span class="si">%s</span><span class="s1">&#39; (self.movie, self.actor)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">    E.Actor._sample = [</span>
<span class="gp">... </span><span class="s1">        (&#39;Keanu Reeves&#39;, ),</span>
<span class="gp">... </span><span class="s1">        (&#39;Winona Ryder&#39;, ),</span>
<span class="gp">... </span><span class="s1">        ]</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">    E.Director._sample = [</span>
<span class="gp">... </span><span class="s1">        (&#39;Richard Linklater&#39;, ),</span>
<span class="gp">... </span><span class="s1">        (&#39;Stephen Herek&#39;, ),</span>
<span class="gp">... </span><span class="s1">        (&#39;Tim Burton&#39;, ),</span>
<span class="gp">... </span><span class="s1">        ]</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">    E.Movie._sample = [</span>
<span class="gp">... </span><span class="s1">        (&#39;A Scanner Darkly&#39;, &#39;2006-07-28&#39;, (&#39;Richard Linklater&#39;, ),</span>
<span class="gp">... </span><span class="s1">            DEFAULT),</span>
<span class="gp">... </span><span class="s1">        (&quot;Bill &amp; Ted&#39;s Excellent Adventure&quot;, &#39;1989-02-17&#39;,</span>
<span class="gp">... </span><span class="s1">            (&#39;Stephen Herek&#39;, ), DEFAULT),</span>
<span class="gp">... </span><span class="s1">        (&#39;Edward Scissorhands&#39;, &#39;1990-12-14&#39;, (&#39;Tim Burton&#39;, ),</span>
<span class="gp">... </span><span class="s1">            DEFAULT),</span>
<span class="gp">... </span><span class="s1">        ]</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">    E.MovieCasting._sample = [</span>
<span class="gp">... </span><span class="s1">        ((&#39;A Scanner Darkly&#39;, ), (&#39;Keanu Reeves&#39;, )),</span>
<span class="gp">... </span><span class="s1">        ((&#39;A Scanner Darkly&#39;, ), (&#39;Winona Ryder&#39;, )),</span>
<span class="gp">... </span><span class="s1">        ((&quot;Bill &amp; Ted&#39;s Excellent Adventure&quot;, ), (&#39;Keanu Reeves&#39;, )),</span>
<span class="gp">... </span><span class="s1">        ((&#39;Edward Scissorhands&#39;, ), (&#39;Winona Ryder&#39;, )),</span>
<span class="gp">... </span><span class="s1">        ]</span>
<span class="gp">... </span><span class="s1">    &#39;&#39;&#39;</span>
</pre></div>
</div>
<div class="section" id="following-relationships">
<h4>Following relationships<a class="headerlink" href="#following-relationships" title="Permalink to this headline">¶</a></h4>
<p>Create a new database with sample data, deleting the old one first,
then open the database in a Python session:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ schevo db create --app=moviereviews --delete --sample sample.db
$ schevo shell sample.db
</pre></div>
</div>
<p>For the doctest, let us do the equivalent:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">done</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">DocTest</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">db</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span><span class="o">.</span><span class="n">populate</span><span class="p">()</span>
</pre></div>
</div>
<p>Let us look at how we might use the relationships that Schevo has kept
for us.  Perhaps in the full implementation of a video store, some
code would like to find all of the movies that Winona Ryder starred
in. This information could be helpful for helping customers and for
promotion of new movies.</p>
<p>Here&#8217;s how you would find those movies:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">actor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Actor</span><span class="o">.</span><span class="n">findone</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Winona Ryder&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">castings</span> <span class="o">=</span> <span class="n">actor</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">movie_castings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies</span> <span class="o">=</span> <span class="p">[</span><span class="n">casting</span><span class="o">.</span><span class="n">movie</span> <span class="k">for</span> <span class="n">casting</span> <span class="ow">in</span> <span class="n">castings</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">movies</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">movie</span>
<span class="go">A Scanner Darkly (2006)</span>
<span class="go">Edward Scissorhands (1990)</span>
</pre></div>
</div>
<p>If we have a specific movie, we can find the actors in it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">movie</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Movie</span><span class="o">.</span><span class="n">findone</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;A Scanner Darkly&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">castings</span> <span class="o">=</span> <span class="n">movie</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">movie_castings</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actors</span> <span class="o">=</span> <span class="p">[</span><span class="n">casting</span><span class="o">.</span><span class="n">actor</span> <span class="k">for</span> <span class="n">casting</span> <span class="ow">in</span> <span class="n">castings</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="n">actors</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">actor</span>
<span class="go">Keanu Reeves</span>
<span class="go">Winona Ryder</span>
</pre></div>
</div>
<p>If we have a director, we can find the movies that he or she has
directed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">director</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Director</span><span class="o">.</span><span class="n">findone</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Richard Linklater&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">movies</span> <span class="o">=</span> <span class="n">director</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">movies</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">movies</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">movie</span>
<span class="gp">...</span>
<span class="go">A Scanner Darkly (2006)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="adding-your-own-api-extensions">
<h3>Adding your own API extensions<a class="headerlink" href="#adding-your-own-api-extensions" title="Permalink to this headline">¶</a></h3>
<p>Schevo lets you add API extensions within the <code class="docutils literal"><span class="pre">x</span></code> namespace. A
separate namespace is used to prevent clashes between extension
methods and field names.</p>
<p>When following the relationships above, there was some boilerplate
when finding out an actor&#8217;s movies, or a movie&#8217;s actors, due to the
<code class="docutils literal"><span class="pre">MovieCasting</span></code> extent that ties them together in a many-to-many
relationship.</p>
<p>The developers of Schevo have found that such intermediary extents are
more useful than trying to embody that type of relationship some other
way. We have run into more than one instance where it became useful to
add additional information <em>about the relationship itself</em> via extra
fields in the intermediary extent.</p>
<p>You can use extension methods to reduce this sort of boilerplate,
while still retaining the full flexibility of Schevo&#8217;s relationship
model. Add a new method called <code class="docutils literal"><span class="pre">x_movies</span></code> to the bottom of the
<code class="docutils literal"><span class="pre">Actor</span></code> class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    class Actor(E.Entity):</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        name = f.string()</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _key(name)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        def x_movies(self):</span>
<span class="gp">... </span><span class="s1">            return [casting.movie</span>
<span class="gp">... </span><span class="s1">                    for casting in self.m.movie_castings()]</span>
<span class="gp">... </span><span class="s1">    &#39;&#39;&#39;</span>
</pre></div>
</div>
<p>Add a new method to the <code class="docutils literal"><span class="pre">Movie</span></code> class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">schema</span> <span class="o">+=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    class Movie(E.Entity):</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        title = f.string()</span>
<span class="gp">... </span><span class="s1">        release_date = f.date()</span>
<span class="gp">... </span><span class="s1">        director = f.entity(&#39;Director&#39;)</span>
<span class="gp">... </span><span class="s1">        description = f.string(multiline=True, required=False)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        _key(title)</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        def x_actors(self):</span>
<span class="gp">... </span><span class="s1">            return [casting.actor</span>
<span class="gp">... </span><span class="s1">                    for casting in self.m.movie_castings()]</span>
<span class="gp">...</span><span class="s1"></span>
<span class="gp">... </span><span class="s1">        def __unicode__(self):</span>
<span class="gp">... </span><span class="s1">            return u&#39;</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%i</span><span class="s1">)&#39; % (self.title, self.release_date.year)</span>
<span class="gp">... </span><span class="s1">    &#39;&#39;&#39;</span>
</pre></div>
</div>
<p>Close the Python session, update the database so its schema has the
new methods available, then open a Python session:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ schevo db update --app=moviereviews sample.db
$ schevo shell sample.db
</pre></div>
</div>
<p>For the doctest, do the equivalent:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">db</span>
</pre></div>
</div>
<p>The relationships demonstrated above are now much easier to traverse:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">actor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Actor</span><span class="o">.</span><span class="n">findone</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Winona Ryder&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">movie</span> <span class="ow">in</span> <span class="n">actor</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">movies</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">movie</span>
<span class="gp">...</span>
<span class="go">A Scanner Darkly (2006)</span>
<span class="go">Edward Scissorhands (1990)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">movie</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Movie</span><span class="o">.</span><span class="n">findone</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;A Scanner Darkly&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">actor</span> <span class="ow">in</span> <span class="n">movie</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">actors</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">actor</span>
<span class="gp">...</span>
<span class="go">Keanu Reeves</span>
<span class="go">Winona Ryder</span>
</pre></div>
</div>
<p>Since there is a one-to-many relationship between directors and
movies, the use of <code class="docutils literal"><span class="pre">director.m.movies()</span></code> stays the same since there
is no intermediate extent used.</p>
</div>
<div class="section" id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h3>
<p>This tutorial has covered the following:</p>
<ul class="simple">
<li>Creating a skeleton for a new Schevo app</li>
<li>Adding entity classes to the schema</li>
<li>Creating and updating Schevo databases</li>
<li>Use of transaction methods and objects to create and update entities</li>
<li>Defining human-friendly summaries of entities</li>
<li>Adding sample data to a database schema</li>
<li>Defining and following relationships that Schevo maintains for you</li>
<li>Extending the API of a database using extension methods</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Schevo Tutorial: Movie Reviews</a><ul>
<li><a class="reference internal" href="#installment-1">Installment 1</a><ul>
<li><a class="reference internal" href="#create-a-schevo-application">Create a Schevo application</a><ul>
<li><a class="reference internal" href="#the-default-database-schema">The default database schema</a></li>
<li><a class="reference internal" href="#namespace-preparation">Namespace preparation</a></li>
<li><a class="reference internal" href="#icon-storage">Icon storage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#some-terminology">Some terminology</a></li>
<li><a class="reference internal" href="#add-an-entity-class-for-movies">Add an entity class for movies</a></li>
<li><a class="reference internal" href="#create-a-database">Create a database</a></li>
<li><a class="reference internal" href="#add-some-movies">Add some movies</a><ul>
<li><a class="reference internal" href="#transactions">Transactions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#object-representations">Object representations</a></li>
<li><a class="reference internal" href="#relationships">Relationships</a><ul>
<li><a class="reference internal" href="#following-relationships">Following relationships</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-your-own-api-extensions">Adding your own API extensions</a></li>
<li><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Schevo Tutorials</a><ul>
  <li><a href="index.html">Movie Review Tutorial</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Movie Review Tutorial</a></li>
      <li>Next: <a href="../../reference/index.html" title="next chapter">Schevo References</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/tutorial/moviereviews/part1.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Etienne Robillard.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.9</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="../../_sources/tutorial/moviereviews/part1.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>