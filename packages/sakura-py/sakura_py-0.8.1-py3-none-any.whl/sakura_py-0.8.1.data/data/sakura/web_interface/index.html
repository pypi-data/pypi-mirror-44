<!--Code started by Michael Ortega for the LIG, January 30th, 2017-->
<!--Maintained by Denis Bouhineau for the LIG, February 1st, 2017 ...-->

<!doctype html>
    <head>
    <meta charset="UTF-8" />
    <script src="js/w3data.js"></script>
    <script src="/webcache/cdnjs/jquery/3.1.1/jquery.min.js"></script>
    <script src="/webcache/cdnjs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="/webcache/cdnjs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>
    <script src="/webcache/cdnjs/ckeditor/4.7.3/ckeditor.js"></script>
    <script src="/webcache/cdnjs/moment.js/2.19.3/moment.min.js"></script>
    <script src="/webcache/cdnjs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
    <script src="/webcache/cdnjs/simplemde/1.11.2/simplemde.min.js"></script>
    <script src="/webcache/cdnjs/x-editable/1.5.0/bootstrap3-editable/js/bootstrap-editable.min.js"></script>

    <link rel="icon" type="image/png" href="media/favicon.png">
    <link rel="stylesheet" href="css/web_interface.css">
    <link rel="stylesheet" href="css/parsley.css">
    <link rel="stylesheet" type="text/css" href="/webcache/cdnjs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/webcache/cdnjs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="/webcache/cdnjs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" type="text/css" href="/webcache/cdnjs/simplemde/1.11.2/simplemde.min.css">
    <link rel="stylesheet" href="/webcache/cdnjs/x-editable/1.5.0/bootstrap3-editable/css/bootstrap-editable.css"/>

    <script>
        /*window.onpopstate = function(event) {
            if (event.state)
                showDiv(event,event.state.where);
            else
                alert('bad event');
        };*/
        window.onpopstate = function(event) {
            console.log('here, onpopstate');
            var evt = document.createEvent('Event');
            evt.initEvent('load', false, false);
            window.dispatchEvent(evt);
        }
        window.onload = function(event) {
            let a = window.location.href.split("#");
            if (a.length>1) {
                // permalink
                cb = function() {
                    // when the page is completely loaded,
                    // look for the div and show it.
                    showDiv(event,a[1]);
                };
            }
            else {
                // nothing to do
                cb = function() {};
            }
            w3IncludeHTML(cb);
        }
    </script>
    </head>
    <body>
        <div class="container-fluid">
            <h1>
                <a onclick="showDiv(event,'');" href="http://sakura.imag.fr" style="cursor: pointer;">
                    <img src="media/logo_Sakura_beta.png" alt="logo_Sakura" height="65" width="280" />
                </a>
            </h1>
            <p>Store and Analyse Data</p>
            <div id="idTopRightWidget" style="top: 0px; right: 0px; width: 160px; position: absolute; text-align: right;">
                <div id="idSignInWidget" name="signInWidget">
                    <a onclick="initiateSignInModal(event);" class="btn" data-toggle="modal" href="#signInModal">
                        <span class="glyphicon glyphicon-user" aria-hidden="true">
                        </span>&nbsp; Sign in &nbsp;
                    </a>
                </div>
                <div id="idEditModeWidget" style="display:none;">
                    <a  onclick="editModeSubmitControl(event);" style="cursor: pointer;">
                        Edit Mode
                    </a>
                </div>
            </div>
            <nav class="navbar navbar-default" style="margin-bottom:1px; ">
                <ul id="navbar_ul" class="nav navbar-nav">
                    <li id="idNavBarHome" class="active">
                        <a onclick="showDiv(event,'');" href="http://sakura.imag.fr" style="cursor: pointer;"><span class="glyphicon glyphicon-home" title="home" aria-hidden="true"></span></a>
                    </li>
                    <li id="idNavBarProjects">
                        <a disabled style="cursor: not-allowed;">Projects</a>
                        <!--<a onclick="showDiv(event,'Projects');" href="http://sakura.imag.fr/Projects" style="cursor: pointer;">Projects</a>-->
                    </li>
                    <li id="idNavBarDatas">
                        <a onclick="showDiv(event,'Datas');" href="http://sakura.imag.fr/Datas" style="cursor: pointer;">Datas</a>
                    </li>
                    <li id="idNavBarOperators">
                        <!--<a disabled style="cursor: not-allowed>Operators</a>-->
                        <a onclick="showDiv(event,'Operators');" href="http://sakura.imag.fr/Operators" style="cursor: pointer;">Operators</a>
                    </li>
                    <li id="idNavBarDataflows">
                        <a onclick="showDiv(event,'Dataflows');" href="http://sakura.imag.fr/Dataflows" style="cursor: pointer;">Dataflows</a>
                    </li>
                    <li id="idNavBarResults">
                        <a disabled style="cursor: not-allowed;">Results</a>
                        <!--<a onclick="showDiv(event,'Results');" href="http://sakura.imag.fr/Results" style="cursor: pointer;">Results</a>-->
                    </li>
                </ul>
                <!--<ul class="nav navbar-nav navbar-right">
                    <li id="idNavBarDocumentation"><a onclick="showDiv(event,'Documentation');" href="http://sakura.imag.fr/Documentation" style="cursor: pointer;">Help</a></li>
                    <li><a href="http://panteda.imag.fr/" targer="_blank">About &nbsp;</a></li>
                </ul>
                -->
            </nav>

            <ol id="breadcrumbtrail" class="breadcrumb" style="margin-bottom:0px; padding-top: 0px; padding-bottom: 0px; background-color: rgb(250, 250, 250); font-size: 12px;">
                <li><a onclick="showDiv(event,'');" href="http://sakura.imag.fr" title="Sakura">Sakura</a></li>
                <li class="active">Home</li>
            </ol>

            <div class="container-fluid" id="main_div">
                <div w3-include-html="divs/home/index.html"></div>
                <div w3-include-html="divs/home/helloYou.html"></div>

                <div w3-include-html="divs/projects/index.html"></div>
                <div w3-include-html="divs/projects/main.html"></div>
                <div w3-include-html="divs/projects/work.html"></div>
                <div w3-include-html="divs/projects/historic.html"></div>

                <div w3-include-html="divs/databases/index.html"></div>
                <div w3-include-html="divs/databases/main.html"></div>
                <div w3-include-html="divs/databases/meta.html"></div>
                <div w3-include-html="divs/databases/work.html"></div>
                <div w3-include-html="divs/databases/historic.html"></div>

                <div w3-include-html="divs/operators/index.html"></div>
                <div w3-include-html="divs/operators/main.html"></div>
                <div w3-include-html="divs/operators/meta.html"></div>
                <div w3-include-html="divs/operators/work.html"></div>
                <div w3-include-html="divs/operators/historic.html"></div>

                <div w3-include-html="divs/dataflows/index.html"></div>
                <div w3-include-html="divs/dataflows/main.html"></div>
                <div w3-include-html="divs/dataflows/meta.html"></div>
                <div w3-include-html="divs/dataflows/work.html"></div>
                <div w3-include-html="divs/dataflows/historic.html"></div>

                <div w3-include-html="divs/results/index.html"></div>
                <div w3-include-html="divs/results/main.html"></div>
                <div w3-include-html="divs/results/work.html"></div>
                <div w3-include-html="divs/results/historic.html"></div>

                <div w3-include-html="divs/documentation/index.html"></div>
                <!-- rms-dev:"signIn/index.html must precede "documentation/cgu.html" for correct stacked modal behavior for CGU-->
                <div w3-include-html="divs/signIn/index.html"></div>
                <div w3-include-html="divs/documentation/cgu.html"></div>
                <div w3-include-html="divs/create/index.html"></div>
                <div w3-include-html="divs/create/databases.html"></div>
                <div w3-include-html="divs/create/dataflows.html"></div>
                <div w3-include-html="divs/colSelect/index.html"></div>
            </div>

            <!--<div class="container" id="divfooter" style="margin-top:50px">
                <p align="center" class="text-muted">Page maintained by the LIG, viewed <span class="label label-primary">127</span> since January 2017, last updated on Oct 2017.</p>
            </div>
            -->
        </div>

        <!--Asking access modal-->
        <div id="web_interface_asking_access_modal" class="modal fade" style="" role="document">
            <div class="modal-dialog modal-md" role="document" style="">
                <div class="modal-content">
                    <div id="web_interface_asking_access_modal_header" class="panel-heading" style="background-color: rgba(91,192,222);">
                        <h3 >Asking Access</h3>
                    </div>
                    <div id="web_interface_asking_access_modal_body" class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button id="web_interface_asking_access_modal_button" type="button" class="btn btn-primary">Send</button>
                    </div>
                </div>
            </div>
        </div>

        <!--Success Modal-->
        <div id="web_interface_success_modal" class="modal fade" style="" role="document">
            <div class="modal-dialog modal-md" role="document" style="">
                <div class="modal-content">
                    <div class="panel-heading" style="padding: 1px;">
                    </div>
                    <div id="web_interface_success_modal_body" class="panel-body" style=" padding: 1px; margin: 5px;">
                        <h3>Success</h3>
                    </div>
                    <div class="panel-footer" style=" padding: 1px;">
                    </div>
                </div>
            </div>
        </div>

        <!--Yes/No Modal-->
        <div id="web_interface_yes_no_modal" class="modal fade" style="" role="document">
            <div class="modal-dialog modal-md" role="document" style="">
                <div class="modal-content">
                    <div id="web_interface_yes_no_modal_header" class="panel-heading" style="background-color: rgba(91,192,222);">
                    </div>
                    <div id="web_interface_yes_no_modal_body" class="modal-body">
                    </div>
                    <div class="modal-footer">
                        <button id="web_interface_yes_no_modal_button" type="button" class="btn btn-primary" onclick="web_interface_change_access_scope();">Proceed</button>
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- STUB ASKING MODAL -->
        <div id="stub_asking_modal" class="modal fade" role="dialog">
            <div class="modal-dialog modal-md" role="dialog">
                <div class="modal-content">
                    <div id="stub_asking_header" class="panel-heading">
                        <h3>Alert Title</h3>
                    </div>
                    <div id="stub_asking_body" class="modal-body">
                        <p> Alert Text</p>
                    </div>
                    <div class="modal-footer">
                        <button id="stub_asking_button_yes"type="button" class="btn btn btn-sm" data-dismiss="modal">Yes</button>
                        <button id="stub_asking_button_no" type="button" class="btn btn-primary btn-sm" data-dismiss="modal">No</button>
                    </div>
                </div>
            </div>
        </div>

        <script src="js/sakura-common.js"></script>
        <script>
            var DEBUG = true;
            sakura.tools.set_debug(true);
        </script>
        <script src="js/alea.js"></script>
        <script src="js/stubs.js"></script>
        <script src="/webcache/cdnjs/parsley.js/2.8.0/parsley.min.js"></script>
        <script src="/webcache/cdnjs/crypto-js/3.1.2/rollups/hmac-sha256.js"></script>
        <script src="/webcache/cdnjs/crypto-js/3.1.2/components/enc-base64-min.js"></script>
        <script src="js/signIn.js"></script>
        <script>
            //Here we ask the hub if there is a current login
            sakura.apis.hub.users.current.info().then(function(result) {
                if (result) {
                    signInWidget = document.getElementsByName("signInWidget")[0];
                    signInWidget.innerHTML = '<a onclick="signOutSubmitControl(event);" style="cursor: pointer;"><span class="glyphicon glyphicon-user" aria-hidden="true"></span>&nbsp;&nbsp;'+result.login+'&nbsp;&nbsp;</a>';
                    current_login = result;
                }
                else {
                    current_login = null;
                }
            });
        </script>

        <script src="js/web_interface.js"></script>
        <script src="js/databases.js"></script>
        <script src="js/operators.js"></script>
        <script src="js/dataflows.js"></script>
    </body>
</html>
